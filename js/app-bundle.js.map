{"version":3,"file":"app-bundle.js","sources":["../node_modules/greenlet/dist/greenlet.m.js","FrameMaker/index.js","app.js"],"sourcesContent":["export default function(n){var e=0,t={},a=new Worker(\"data:,$$=\"+n+\";onmessage=\"+function(n){Promise.resolve(n.data[1]).then(function(n){return $$.apply($$,n)}).then(function(e){postMessage([n.data[0],0,e],[e].filter(function(n){return n instanceof ArrayBuffer||n instanceof MessagePort||n instanceof ImageBitmap}))},function(e){postMessage([n.data[0],1,\"\"+e])})});return a.onmessage=function(n){t[n.data[0]][n.data[1]](n.data[2]),t[n.data[0]]=null},function(n){return n=[].slice.call(arguments),new Promise(function(){t[++e]=arguments,a.postMessage([e,n],n.filter(function(n){return n instanceof ArrayBuffer||n instanceof MessagePort||n instanceof ImageBitmap}))})}};\n//# sourceMappingURL=greenlet.m.js.map\n","'use strict';\nimport greenlet from 'greenlet';\n\nconst calculateAnimationBounds = greenlet(function (cgsEntry = [], frames = []) {\n  let xMin = Infinity, yMin = Infinity, xMax = -Infinity, yMax = -Infinity;\n  cgsEntry.forEach(cgsFrame => {\n    const frameData = frames[cgsFrame.frameIndex];\n    const xOffset = Math.abs(cgsFrame.xOffset) || 0;\n    const yOffset = Math.abs(cgsFrame.yOffset) || 0;\n    frameData.frames.forEach(frame => {\n      // bounds are x +- width and y += height\n      const w = frame.img.width, h = frame.img.height;\n      xMin = Math.min(xMin, frame.position.x - w - xOffset);\n      yMin = Math.min(yMin, frame.position.y - h - yOffset);\n\n      xMax = Math.max(xMax, frame.position.x + w + xOffset);\n      yMax = Math.max(yMax, frame.position.y + h + yOffset);\n    });\n  });\n  return {\n    x: [xMin, xMax],\n    y: [yMin, yMax],\n    w: xMax - xMin,\n    h: yMax - yMin,\n  };\n});\n\nexport default class FrameMaker {\n  constructor (cggCsv = []) {\n    this._frames = this._processCgg(cggCsv);\n    this._animations = {};\n  }\n\n  _cggLineToEntry (frameLine = [], index = -1) {\n    const entry = {\n      anchorType: +frameLine[0],\n      partCount: +frameLine[1],\n      frames: [],\n    };\n\n    let curIndex = 2, partCount = 0;\n    const frameIsValid = (frame = {}) => {\n      for (const field in frame) {\n        if (field !== 'position' && field !== 'img' && isNaN(frame[field])) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    // parse each part in the line\n    while (partCount < entry.partCount) {\n      const frame = {\n        position: { // origin is middle\n          x: +frameLine[curIndex++],\n          y: +frameLine[curIndex++],\n        },\n        nextType: +frameLine[curIndex++],\n        blendMode: +frameLine[curIndex++],\n        opacity: +frameLine[curIndex++],\n        rotate: +frameLine[curIndex++],\n        img: { // origin is top left\n          x: +frameLine[curIndex++],\n          y: +frameLine[curIndex++],\n          width: +frameLine[curIndex++],\n          height: +frameLine[curIndex++],\n        },\n        pageId: +frameLine[curIndex++],\n      };\n      if (frameIsValid(frame)) {\n        partCount++;\n        entry.frames.push(frame);\n      } else {\n        console.warn('Encountered NaN frame', frame, index);\n      }\n    }\n    return entry;\n  }\n\n  _processCgg (cggCsv = []) {\n    return cggCsv\n      .filter(frame => frame.length >= 2) // filter out empty frames\n      .map((frame, i) => this._cggLineToEntry(frame, i));\n  }\n\n  _processCgs (cgsCsv = []) {\n    return cgsCsv.map(frame => ({\n      frameIndex: +frame[0], // same index in cgg\n      xOffset: +frame[1],\n      yOffset: +frame[2],\n      frameDelay: +frame[3],\n    })).filter((frame, i, fullArr) => {\n      const isValid = Object.values(frame).every(v => !isNaN(v));\n      if (!isValid) {\n        console.warn('Ignoring NaN CGS line', frame, i, fullArr);\n      }\n      return isValid;\n    }); // filter out unparseable\n  }\n\n  async addAnimation (key = 'name', csv = []) {\n    const cgsFrames = this._processCgs(csv);\n    const bounds = await calculateAnimationBounds(cgsFrames, this._frames);\n    const tempCanvas = document.createElement('canvas');\n    tempCanvas.id = key;\n\n    this._animations[key] = {\n      frames: cgsFrames,\n      bounds,\n      tempCanvas,\n    };\n  }\n\n  drawFrame ({\n    spritesheets = [], // array of img elements containing sprite sheets\n    animationName = 'name', animationIndex = -1,\n    targetCanvas = document.createElement('canvas'),\n  }) {\n    const animationEntry = this._animations[animationName];\n    if (!animationEntry) {\n      throw new Error(`No animation entry found with name ${animationName}`);\n    }\n\n    const { bounds, tempCanvas } = animationEntry;\n    const cgsFrame = animationEntry.frames[animationIndex];\n    const cggFrame = this._frames[cgsFrame.frameIndex];\n\n    // update width and height as necessary\n    if (tempCanvas.width !== targetCanvas.width) {\n      tempCanvas.width = targetCanvas.width;\n    }\n    if (tempCanvas.height !== targetCanvas.height) {\n      tempCanvas.height = targetCanvas.height;\n    }\n\n    const origin = {\n      x: targetCanvas.width / 2,\n      y: targetCanvas.height / 2,\n    };\n    const targetContext = targetCanvas.getContext('2d');\n    const tempContext = tempCanvas.getContext('2d');\n    // render each part in reverse order\n    cggFrame.frames.slice().reverse().forEach(frame => {\n      const sourceWidth = frame.img.width, sourceHeight = frame.img.height;\n      tempContext.clearRect(0, 0, tempCanvas.width, tempCanvas.height);\n      tempContext.globalAlpha = frame.opacity / 100;\n\n      const flipX = frame.next_type == 1 || frame.next_type == 3;\n      const flipY = frame.next_type == 2 || frame.next_type == 3;\n      tempContext.save();\n      if (flipX || flipY || frame.rotate !== 0) {\n        tempContext.translate(flipX ? sourceWidth : 0, flipY ? sourceHeight : 0);\n        tempContext.scale(flipX ? -1 : 1, flipY ? -1 : 1);\n\n        // TODO: handle rotations\n      }\n      tempContext.drawImage(\n        spritesheets[frame.pageId],\n        frame.img.x, frame.img.y, sourceWidth, sourceHeight,\n        // TODO: handle offsets here?\n        frame.position.x + origin.x, frame.position.y + origin.y, sourceWidth, sourceHeight, \n      );\n      tempContext.restore();\n\n      // blend code based off of this: http://pastebin.com/vXc0yNRh\n      if (frame.blendMode === 1) {\n        const imgData = tempContext.getImageData(0, 0, tempCanvas.width, tempCanvas.height);\n        const pixelData = imgData.data;\n        for (let p = 0; p < pixelData.length; p += 4) {\n          let [r, g, b, a] = [pixelData[p], pixelData[p + 1], pixelData[p + 2], pixelData[p + 3]];\n          if (a > 0) {\n            const multiplier = 1 + (a * frame.opacity / 100) / 255.0;\n            r = Math.min(255, Math.floor(r * multiplier));\n            g = Math.min(255, Math.floor(g * multiplier));\n            b = Math.min(255, Math.floor(b * multiplier));\n            a = Math.floor(((r + g + b) / 3) * frame.opacity / 100);\n\n            [pixelData[p], pixelData[p + 1], pixelData[p + 2], pixelData[p + 3]] = [r, g, b, a];\n          }\n        }\n        tempContext.putImageData(imgData, 0, 0);\n      }\n\n      // copy final result to canvas\n      targetContext.drawImage(tempCanvas, 0, 0);\n    });\n  }\n}\n","'use strict';\n\nimport FrameMaker from './FrameMaker';\n\nexport default class App {\n  constructor () {\n    this._frameMaker = null;\n  }\n\n  static get SAMPLE_URLS () {\n    const baseUrl = 'http://static-bravefrontier.gumi-europe.net/content/';\n    const filepaths = {\n      cgg: 'unit/cgg/',\n      cgs: 'unit/cgs/',\n      anime: 'unit/img/'\n    };\n    return {\n      anime: `/getImage/${encodeURIComponent(baseUrl + filepaths.anime + 'unit_anime_720216.png')}`,\n      cgg: `/get/${encodeURIComponent(baseUrl + filepaths.cgg + 'unit_cgg_720216.csv')}`,\n      cgs: `/get/${encodeURIComponent(baseUrl + filepaths.cgs + 'unit_atk_cgs_720216.csv')}`,\n    };\n  }\n\n  _loadCsv (path) {\n    return fetch(path).then(r => r.text())\n      .then(r => r.split('\\n').map(line => line.split(',')));\n  }\n\n  async init () {\n    const cggData = await this._loadCsv(App.SAMPLE_URLS.cgg);\n    this._frameMaker = new FrameMaker(cggData);\n\n    const cgsData = await this._loadCsv(App.SAMPLE_URLS.cgs);\n    await this._frameMaker.addAnimation('idle', cgsData);\n\n    const targetCanvas = document.querySelector('canvas#target');\n    targetCanvas.width = 500;\n    targetCanvas.height = 500;\n\n    const spritesheet = document.querySelector('img.spritesheet');\n    await new Promise((fulfill, reject) => {\n      spritesheet.onload = fulfill;\n      spritesheet.onerror = reject;\n\n      spritesheet.src = App.SAMPLE_URLS.anime;\n    });\n  }\n\n  get frameMaker () {\n    return this._frameMaker;\n  }\n}\n"],"names":[],"mappings":"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"}