{"version":3,"file":"app-bundle.js","sources":["../node_modules/greenlet/dist/greenlet.m.js","FrameMaker/index.js","app.js"],"sourcesContent":["export default function(n){var e=0,t={},a=new Worker(\"data:,$$=\"+n+\";onmessage=\"+function(n){Promise.resolve(n.data[1]).then(function(n){return $$.apply($$,n)}).then(function(e){postMessage([n.data[0],0,e],[e].filter(function(n){return n instanceof ArrayBuffer||n instanceof MessagePort||n instanceof ImageBitmap}))},function(e){postMessage([n.data[0],1,\"\"+e])})});return a.onmessage=function(n){t[n.data[0]][n.data[1]](n.data[2]),t[n.data[0]]=null},function(n){return n=[].slice.call(arguments),new Promise(function(){t[++e]=arguments,a.postMessage([e,n],n.filter(function(n){return n instanceof ArrayBuffer||n instanceof MessagePort||n instanceof ImageBitmap}))})}};\n//# sourceMappingURL=greenlet.m.js.map\n","'use strict';\r\nimport greenlet from 'greenlet';\r\n\r\nconst calculateAnimationBounds = greenlet(function (cgsEntry = [], frames = []) {\r\n  let xMin = Infinity, yMin = Infinity, xMax = -Infinity, yMax = -Infinity;\r\n  cgsEntry.forEach(cgsFrame => {\r\n    const frameData = frames[cgsFrame.frameIndex];\r\n    const xOffset = Math.abs(cgsFrame.xOffset) || 0;\r\n    const yOffset = Math.abs(cgsFrame.yOffset) || 0;\r\n    frameData.parts.forEach(part => {\r\n      // bounds are x +- width and y += height\r\n      const w = part.img.width, h = part.img.height;\r\n      xMin = Math.min(xMin, part.position.x - w - xOffset);\r\n      yMin = Math.min(yMin, part.position.y - h - yOffset);\r\n\r\n      xMax = Math.max(xMax, part.position.x + w + xOffset);\r\n      yMax = Math.max(yMax, part.position.y + h + yOffset);\r\n    });\r\n  });\r\n  return {\r\n    x: [xMin, xMax],\r\n    y: [yMin, yMax],\r\n    w: xMax - xMin,\r\n    h: yMax - yMin,\r\n  };\r\n});\r\n\r\nexport default class FrameMaker {\r\n  constructor (cggCsv = []) {\r\n    this._frames = this._processCgg(cggCsv);\r\n    this._animations = {};\r\n  }\r\n\r\n  _cggLineToEntry (frameLine = [], index = -1) {\r\n    const entry = {\r\n      anchorType: +frameLine[0],\r\n      partCount: +frameLine[1],\r\n      parts: [],\r\n    };\r\n\r\n    let curIndex = 2, partCount = 0;\r\n    const partIsValid = (part = {}) => {\r\n      for (const field in part) {\r\n        if (field !== 'position' && field !== 'img' && isNaN(part[field])) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    };\r\n\r\n    // parse each part in the line\r\n    while (partCount < entry.partCount) {\r\n      const part = {\r\n        position: { // origin is middle\r\n          x: +frameLine[curIndex++],\r\n          y: +frameLine[curIndex++],\r\n        },\r\n        nextType: +frameLine[curIndex++],\r\n        blendMode: +frameLine[curIndex++],\r\n        opacity: +frameLine[curIndex++],\r\n        rotate: +frameLine[curIndex++],\r\n        img: { // origin is top left\r\n          x: +frameLine[curIndex++],\r\n          y: +frameLine[curIndex++],\r\n          width: +frameLine[curIndex++],\r\n          height: +frameLine[curIndex++],\r\n        },\r\n        pageId: +frameLine[curIndex++],\r\n      };\r\n      if (partIsValid(part)) {\r\n        partCount++;\r\n        entry.parts.push(part);\r\n      } else {\r\n        console.warn('Encountered NaN part', part, index);\r\n      }\r\n    }\r\n    return entry;\r\n  }\r\n\r\n  _processCgg (cggCsv = []) {\r\n    return cggCsv\r\n      .filter(frame => frame.length >= 2) // filter out empty frames\r\n      .map((frame, i) => this._cggLineToEntry(frame, i));\r\n  }\r\n\r\n  _processCgs (cgsCsv = []) {\r\n    return cgsCsv.map(frame => ({\r\n      frameIndex: +frame[0], // same index in cgg\r\n      xOffset: +frame[1],\r\n      yOffset: +frame[2],\r\n      frameDelay: +frame[3],\r\n    })).filter((frame, i, fullArr) => {\r\n      const isValid = Object.values(frame).every(v => !isNaN(v));\r\n      if (!isValid) {\r\n        console.warn('Ignoring NaN CGS line', frame, i, fullArr);\r\n      }\r\n      return isValid;\r\n    }); // filter out unparseable\r\n  }\r\n\r\n  async addAnimation (key = 'name', csv = []) {\r\n    const cgsFrames = this._processCgs(csv);\r\n    const bounds = await calculateAnimationBounds(cgsFrames, this._frames);\r\n\r\n    this._animations[key] = {\r\n      frames: cgsFrames,\r\n      bounds,\r\n      cachedCanvases: {},\r\n    };\r\n  }\r\n\r\n  getAnimation (key = 'name') {\r\n    return this._animations[key];\r\n  }\r\n\r\n  drawFrame ({\r\n    spritesheets = [], // array of img elements containing sprite sheets\r\n    animationName = 'name', animationIndex = -1,\r\n    targetCanvas = document.createElement('canvas'),\r\n    forceRedraw = false,\r\n  }) {\r\n    const animationEntry = this._animations[animationName];\r\n    if (!animationEntry) {\r\n      throw new Error(`No animation entry found with name ${animationName}`);\r\n    }\r\n\r\n    const targetContext = targetCanvas.getContext('2d');\r\n    const { bounds, cachedCanvases } = animationEntry;\r\n    if (cachedCanvases[animationIndex] && !forceRedraw) {\r\n      console.debug(`drawing cached frame [cgs:${animationIndex}]`, cggFrame);\r\n      targetContext.drawImage(cachedCanvases[animationIndex], 0, 0);\r\n      return;\r\n    }\r\n    const cgsFrame = animationEntry.frames[animationIndex];\r\n    const cggFrame = this._frames[cgsFrame.frameIndex];\r\n    console.debug(`drawing frame [cgs:${animationIndex}, cgg:${cgsFrame.frameIndex}]`, cggFrame);\r\n\r\n    const tempCanvasSize = (spritesheets.reduce((acc, val) => Math.max(acc, val.width, val.height), Math.max(bounds.w, bounds.h))) * 2;\r\n    // used as a temp canvas for rotating/flipping parts\r\n    const tempCanvas = document.createElement('canvas');\r\n    tempCanvas.width = tempCanvasSize;\r\n    tempCanvas.height = tempCanvasSize;\r\n\r\n    // final frame rendered here, to be cached\r\n    const frameCanvas = document.createElement('canvas');\r\n    frameCanvas.width = targetCanvas.width;\r\n    frameCanvas.height = targetCanvas.height;\r\n\r\n    const origin = {\r\n      x: frameCanvas.width / 2,\r\n      y: frameCanvas.height / 2,\r\n    };\r\n    const tempContext = tempCanvas.getContext('2d');\r\n    const frameContext = frameCanvas.getContext('2d');\r\n    // render each part in reverse order onto the frameCanvas\r\n    cggFrame.parts.slice().reverse().forEach((part, i) => {\r\n      const sourceWidth = part.img.width, sourceHeight = part.img.height;\r\n      const targetX = part.position.x + origin.x,\r\n        targetY = part.position.y + origin.y;\r\n      tempContext.clearRect(0, 0, tempCanvas.width, tempCanvas.height);\r\n      tempContext.globalAlpha = part.opacity / 100;\r\n\r\n      const flipX = part.nextType === 1 || part.nextType === 3;\r\n      const flipY = part.nextType === 2 || part.nextType === 3;\r\n\r\n      tempContext.save(); \r\n      let tempX = tempCanvas.width / 2 - sourceWidth / 2,\r\n        tempY = tempCanvas.height / 2 - sourceHeight / 2;\r\n      if (flipX || flipY) {\r\n        tempContext.translate(flipX ? sourceWidth : 0, flipY ? sourceHeight : 0);\r\n        tempContext.scale(flipX ? -1 : 1, flipY ? -1 : 1);\r\n        tempX -= (flipX ? tempCanvas.width - sourceWidth : 0);\r\n        tempY -= (flipY ? tempCanvas.height - sourceHeight : 0);\r\n      }\r\n      // if (part.rotate !== 0) {\r\n      //   console.debug('rotating', part.rotate);\r\n      //   tempContext.translate(targetX, targetY);\r\n      //   tempContext.rotate(part.rotate * Math.PI / 180);\r\n      //   tempContext.translate(-(targetX), -(targetY));\r\n      //   // targetY += sourceHeight / 2;\r\n      //   // targetX -= sourceWidth;\r\n      // }\r\n      // draw part onto center of part canvas\r\n      tempContext.drawImage(\r\n        spritesheets[part.pageId],\r\n        part.img.x, part.img.y, sourceWidth, sourceHeight,\r\n        // TODO: handle offsets here?\r\n        // (flipX ? targetX - tempCanvas.width - sourceWidth / 2 : targetX),\r\n        // (flipY ? targetY - tempCanvas.height + sourceHeight / 2 : targetY),\r\n        tempX, tempY,\r\n        sourceWidth, sourceHeight,\r\n      );\r\n      tempContext.restore();\r\n\r\n      // blend code based off of this: http://pastebin.com/vXc0yNRh\r\n      if (part.blendMode === 1) {\r\n        const imgData = tempContext.getImageData(0, 0, tempCanvas.width, tempCanvas.height);\r\n        const pixelData = imgData.data;\r\n        for (let p = 0; p < pixelData.length; p += 4) {\r\n          let [r, g, b, a] = [pixelData[p], pixelData[p + 1], pixelData[p + 2], pixelData[p + 3]];\r\n          if (a > 0) {\r\n            const multiplier = 1 + (a * part.opacity / 100) / 255.0;\r\n            r = Math.min(255, Math.floor(r * multiplier));\r\n            g = Math.min(255, Math.floor(g * multiplier));\r\n            b = Math.min(255, Math.floor(b * multiplier));\r\n            a = Math.floor(((r + g + b) / 3) * part.opacity / 100);\r\n\r\n            [pixelData[p], pixelData[p + 1], pixelData[p + 2], pixelData[p + 3]] = [r, g, b, a];\r\n          }\r\n        }\r\n        tempContext.putImageData(imgData, 0, 0);\r\n      }\r\n\r\n      // const bodyCanvas = document.createElement('canvas');\r\n      // bodyCanvas.width = tempCanvas.width;\r\n      // bodyCanvas.height = tempCanvas.height;\r\n      // bodyCanvas.dataset.cgsIndex = cggFrame.parts.length - 1 - i;\r\n      // const bodyContext = bodyCanvas.getContext('2d');\r\n      // bodyContext.globalAlpha = part.opacity / 100;\r\n      // bodyContext.drawImage(tempCanvas, 0, 0);\r\n      // bodyContext.beginPath();\r\n      // bodyContext.rect(tempCanvas.width / 2 - sourceWidth / 2, tempCanvas.height / 2 - sourceHeight / 2, sourceWidth, sourceHeight);\r\n      // bodyContext.stroke();\r\n      // document.body.appendChild(bodyCanvas);\r\n\r\n      // copy part result to frame canvas\r\n      // const xOffset = tempCanvas.width - frameCanvas.width;\r\n      // const yOffset = tempCanvas.height - frameCanvas.height;\r\n      frameContext.drawImage(\r\n        tempCanvas,\r\n        0, 0, // start at top left of temp canvas\r\n        tempCanvas.width, tempCanvas.height,\r\n        origin.x + part.position.x + sourceWidth / 2 - tempCanvasSize / 2,\r\n        origin.y + part.position.y + sourceHeight / 2 - tempCanvasSize / 2,\r\n        tempCanvas.width, tempCanvas.height,\r\n      );\r\n    });\r\n    // document.body.appendChild(frameCanvas);\r\n    targetContext.drawImage(frameCanvas, 0, 0);\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport FrameMaker from './FrameMaker';\r\n\r\nexport default class App {\r\n  constructor () {\r\n    this._frameMaker = null;\r\n    this._targetCanvas = null;\r\n    this._frameIndex = -1;\r\n    this._currentAnimation = null;\r\n  }\r\n\r\n  static get SAMPLE_URLS () {\r\n    const baseUrl = 'http://static-bravefrontier.gumi-europe.net/content/';\r\n    const filepaths = {\r\n      cgg: 'unit/cgg/',\r\n      cgs: 'unit/cgs/',\r\n      anime: 'unit/img/'\r\n    };\r\n    return {\r\n      anime: `/getImage/${encodeURIComponent(baseUrl + filepaths.anime + 'unit_anime_750216.png')}`,\r\n      cgg: `/get/${encodeURIComponent(baseUrl + filepaths.cgg + 'unit_cgg_750216.csv')}`,\r\n      cgs: `/get/${encodeURIComponent(baseUrl + filepaths.cgs + 'unit_skill_cgs_750216.csv')}`,\r\n    };\r\n  }\r\n\r\n  _loadCsv (path) {\r\n    return fetch(path).then(r => r.text())\r\n      .then(r => r.split('\\n').map(line => line.split(',')));\r\n  }\r\n\r\n  async init () {\r\n    const cggData = await this._loadCsv(App.SAMPLE_URLS.cgg);\r\n    this._frameMaker = new FrameMaker(cggData);\r\n\r\n    const cgsData = await this._loadCsv(App.SAMPLE_URLS.cgs);\r\n    await this._frameMaker.addAnimation('skill', cgsData);\r\n\r\n    const targetCanvas = document.querySelector('canvas#target');\r\n    targetCanvas.width = 2000;\r\n    targetCanvas.height = 2000;\r\n    this._targetCanvas = targetCanvas;\r\n\r\n    const spritesheet = document.querySelector('img.spritesheet');\r\n    await new Promise((fulfill, reject) => {\r\n      spritesheet.onload = fulfill;\r\n      spritesheet.onerror = reject;\r\n\r\n      spritesheet.src = App.SAMPLE_URLS.anime;\r\n    });\r\n\r\n    this._currentAnimation = 'skill';\r\n  }\r\n\r\n  renderFrame (index) {\r\n    const frameToRender = !isNaN(index) ? +index : this._frameIndex;\r\n    const animation = this._frameMaker.getAnimation(this._currentAnimation);\r\n    const isValidIndex = frameToRender < animation.frames.length && frameToRender >= 0;\r\n\r\n    const context = this._targetCanvas.getContext('2d');\r\n    context.clearRect(0, 0, this._targetCanvas.width, this._targetCanvas.height);\r\n    this._frameMaker.drawFrame({\r\n      spritesheets: [document.querySelector('img.spritesheet')],\r\n      animationName: this._currentAnimation,\r\n      animationIndex: isValidIndex ? frameToRender : 0,\r\n      targetCanvas: this._targetCanvas,\r\n    });\r\n\r\n    // mark center of canvas\r\n    context.save();\r\n    context.fillStyle = 'red';\r\n    context.beginPath();\r\n    context.ellipse(this._targetCanvas.width / 2, this._targetCanvas.height / 2, 3, 3, Math.PI / 2, 0, Math.PI * 2);\r\n    context.fill();\r\n    context.restore();\r\n  \r\n    this._frameIndex = isValidIndex ? frameToRender + 1 : 0;\r\n  }\r\n\r\n  get frameMaker () {\r\n    return this._frameMaker;\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}